# WAP Golden Configuration - {{ wap_golden_config._meta.wap_type }}
# Pulled from: {{ wap_golden_config._meta.pulled_from }}
# Pull date: {{ wap_golden_config._meta.pulled_at }}
# Target group: {{ wap_golden_config._meta.target_group }}
#
# This file is auto-generated by playbooks/pull_wap_golden_config.yml
# Manual edits will be overwritten on next pull.
---

# Metadata about this golden config
wap_golden_config_meta:
  source_wap: "{{ wap_golden_config._meta.pulled_from }}"
  pulled_at: "{{ wap_golden_config._meta.pulled_at }}"
  wap_type: "{{ wap_golden_config._meta.wap_type }}"

# System configuration
wap_system:
{% if wap_golden_config.system %}
{% for key, value in wap_golden_config.system.items() %}
  {{ key }}: {{ value | to_nice_yaml | trim | indent(2) if value is mapping else ('"' ~ value ~ '"' if value is string else value) }}
{% endfor %}
{% else %}
  {}
{% endif %}

# Radio configuration (channels, power, etc.)
wap_radio:
{% if wap_golden_config.radio %}
{% for key, value in wap_golden_config.radio.items() %}
  {{ key }}: {{ value | to_nice_yaml | trim | indent(2) if value is mapping else ('"' ~ value ~ '"' if value is string else value) }}
{% endfor %}
{% else %}
  {}
{% endif %}

# SSID configurations
wap_ssids:
{% for ssid in wap_golden_config.ssids %}
  - name: "{{ ssid.name | default('UNNAMED') }}"
{% if ssid.encryption is defined %}
    encryption: "{{ ssid.encryption }}"
{% endif %}
{% if ssid.vlan is defined %}
    vlan: "{{ ssid.vlan }}"
{% endif %}
{% if ssid.isolation is defined %}
    isolation: {{ ssid.isolation | lower }}
{% endif %}
{% if ssid.hidden is defined %}
    hidden: {{ ssid.hidden | lower }}
{% endif %}
{% if ssid.band_steering is defined %}
    band_steering: {{ ssid.band_steering | lower }}
{% endif %}
{% if ssid.radio is defined %}
    radio: "{{ ssid.radio }}"
{% endif %}
{% if ssid.enabled is defined %}
    enabled: {{ ssid.enabled | lower }}
{% endif %}
{% if ssid.passphrase is defined %}
    # Note: Passphrase stored separately in vault for security
    # passphrase: "{{ '{{ wap_ssid_' ~ (ssid.name | lower | regex_replace('[^a-z0-9]', '_')) ~ '_passphrase }}' }}"
{% endif %}
{% endfor %}
{% if not wap_golden_config.ssids %}
  []
{% endif %}

